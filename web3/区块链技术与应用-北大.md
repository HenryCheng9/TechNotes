# Lecture 1 密码学原理
> hash function, 签名

## Hash function
三个性质：
1. collision resistance
2. hiding
3. puzzle friendly

example:
MD5：目前已经找到可以产生碰撞的方法
SHA-256(Secure hash algorithm)，目前 Bitcoin 在用的

**Proof of work in Bitcoin**
H(Block header + nonce) <= target
Find the nonce by brute force.

Difficult to solve, but easy to verify.

## 签名
比特币的账户管理模式：注册一个账户的过程就是创建一个公私钥对(public key, private key)的过程.


# Lecture 2 数据结构
> Hash pointer, Merkle tree

## Hash pointer
- Location
- Value



# Lecture 5 BTC的实现

tx-based ledger
UTXO: Unspent tx output (maintained by full node)
1. Hash of tx producing the output
2. Which number of this output in the tx

UTXO can provide double-spending
UTXO must be maintained in the memory of the full nodes in order to get fast speed

total inputs = total outputs
tx fee: the second incentive mechanism

Aftre 210 millions blocks, coinbase will become the half

![[Pasted image 20230109075215.png]]

注意 nonce 的空间只有 4 个字节，因此可能遍历了所有的可能都找不到符合条件的 Hash。因此我们可以通过 coinbase 来调整，coinbase 是铸币交易，没有任何的输入，所以它的值可以是随意的。通过调整 coinbase 和 nonce 来扩大搜索空间。

```go
for coinbase = 0; coinbase < MAX_COINBASE; coinbase++ {
	for nonce = 0; nonce < MAX_NONCE ;nonce++ {
		if SHA256(nonce + coinbase[0:8]) 
	}
}
```

![[Pasted image 20230109075357.png]]

比特币中验证交易的合法性，通过将 input scripts 和 output scripts 配对后执行来完成的。
将某一个交易的输入脚本和这个交易中币的来源的交易的输出脚本配对。如果能顺利执行，那么说明这个交易是合法的。

![[Pasted image 20230109075916.png]]
## 挖矿的概率

Bernoulli trial: a random experiment with binary outcome
Bernoulli process: a sequence of independent Bernoulli trials
memoryless

试验次数很多的情况下，可以近似为
Poisson process
exponential distribution

![[next block probability | 1000]]

如果当前还没有挖矿成功，那么还需要多久才能成功？10min，和过去的时间无关
progress free


geometrics series

$$
210000 \times 50 + 210000 \times 25 + 210000 \times 12.5 + ... + 
= 21000000
$$

比特币的稀缺性是人为造成的。
挖矿的过程本身是没有意义的，但是对维护比特币的安全性是至关重要的。
Bitcoin is secured by mining. 提供了一种凭借算力投票的机制。

## 比特币的安全性

confirmation
![[confirmation|1000]]

selfish mining
https://zhuanlan.zhihu.com/p/52901666